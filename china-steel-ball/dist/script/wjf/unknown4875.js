window.console=window.console||function(){},Object.assign=Object.assign||function(a){for(var b=Array.prototype.slice.call(arguments).slice(1),c=0,d=b.length;c<d;c++){var e=b[c];if("object"==typeof e)for(var f in e)a[f]=e[f]}return a},window.WJF={},WJF.constants={SAVE_ACCOUNT_KEY:"MAIL_ACCOUNT",COMPANY_NAME:I18NMessage.common.MY_COMPANY,AJAX_LOADING_ENABLE:!1,AJAX_ERROR_MSG:I18NMessage.common.SYSTEM_ERROR_WAITING_RETRY,EN_DAY_NAMES:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),CN_DAY_NAMES:I18NMessage.common.DATE_WEEKS.split(" "),CN_DAY_STATUS:I18NMessage.common.DATE_DAYS.split(" "),LANG_MAPPING:{en:"en-US","en-US":"en-US",zh:"zh-CN","zh-CN":"zh-CN","zh-TW":"zh-TW"},currentMS:(new Date).getTime(),GOON_GAP_TIME:3e3},WJF.util={storage:window.localStorage||null,_count:0,_prefix:(new Date).getTime(),generateId:function(){return this._prefix+"_"+this._count++},cookie:function(a,b,c){if("undefined"==typeof b){var d=null;if(document.cookie&&""!=document.cookie)for(var e=document.cookie.split(";"),f=0;f<e.length;f++){var g=jQuery.trim(e[f]);if(g.substring(0,a.length+1)==a+"="){d=decodeURIComponent(g.substring(a.length+1));break}}return d}c=c||{},null===b&&(b="",c=$.extend({},c),c.expires=-1);var h="";if(c.expires&&("number"==typeof c.expires||c.expires.toUTCString)){var i;"number"==typeof c.expires?(i=new Date,i.setTime(i.getTime()+24*c.expires*60*60*1e3)):i=c.expires,h="; expires="+i.toUTCString()}c.path=c.path||"/";var j=c.path?"; path="+c.path:"",k=c.domain?"; domain="+c.domain:"",l=c.secure?"; secure":"";document.cookie=[a,"=",encodeURIComponent(b),h,j,k,l].join("")},setItem:function(a,b,c){if(c=c||{},this.storage){this.storage.getItem(a)&&this.storage.removeItem(a);try{return this.storage.setItem(a,b),!0}catch(d){var e=!1;return c.error&&(e=c.error(d)),e===!1&&"QuotaExceededError"==d.name&&(window.localStorage.clear(),window.console.warn(I18NMessage.common.STORE_EXCESS_CLEAR_CURRENT+" [已清空]")),!1}}},removeItem:function(a){this.storage&&this.storage.removeItem(a)},getItem:function(a,b){return this.storage?this.storage.getItem(a)||b:b},formatDate:function(a,b){b=b||new Date,a=a||"yyyy-MM-dd hh:mm:ss";var c={"M+":b.getMonth()+1,"d+":b.getDate(),"h+":b.getHours(),"m+":b.getMinutes(),"s+":b.getSeconds(),"q+":Math.floor((b.getMonth()+3)/3),S:b.getMilliseconds()};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(b.getFullYear()+"").substr(4-RegExp.$1.length)));for(var d in c)new RegExp("("+d+")").test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?c[d]:("00"+c[d]).substr((""+c[d]).length)));return a},dateFormatter:function(a,b){return b=b||"yyyy-MM-dd",this.formatDate(b,a)},getDayOfWeek:function(a){var b=WJF.constants.CN_DAY_NAMES[a.getDay()];return b},getDayStatus:function(a){return a.getHours()<12?WJF.constants.CN_DAY_STATUS[0]:12==a.getHours()?WJF.constants.CN_DAY_STATUS[1]:a.getHours()>12?WJF.constants.CN_DAY_STATUS[2]:void 0},getCurrentMS:function(a){return WJF.constants.currentMS},updateCurrentMS:function(a){WJF.constants.currentMS=a},roundDate:function(a,b){return"undefined"==typeof b&&(b=!1),"number"!=typeof a&&"string"!=typeof a||(a=new Date(a)),b===!0?(a.setHours(23),a.setMinutes(59),a.setSeconds(59),a.setMilliseconds(999)):b===!1&&(a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0)),a},getNextMonthDate:function(a,b){return this.getGapDate(a,b)},getGapDate:function(a,b){a=a||new Date;var c=[31,28,31,30,31,30,31,31,30,31,30,31];if(0==b.month||null==b.month)return new Date(a.getTime()+24*(b.days||0)*60*60*1e3);var d=a.getFullYear(),e=a.getMonth(),f=a.getDate();e+=+b.month,e>11&&(d+=Math.floor(e/12)),e%=12;var g=new Date(d+"/"+(e+1)+"/"+f);return g.getMonth()!=e&&(c[1]=this.isLeapYear(d)?29:28,g=new Date(d+"/"+(e+1)+"/"+c[e])),g},getUrlParams:function(a,b,c){b=b||window.location.search,b=!b.match(/^\?/)&&b.match(/\?/)?b.split("?")[1]:b.replace(/^\?/,"");for(var d=/(&|^)([^=]+)=([^&]*)(&|$)/,e=b.match(d),f={};e;)null!=f[e[2]]?(f[e[2]]=[f[e[2]]],f[e[2]].push(e[3])):f[e[2]]=e[3],b=b.replace(e[0],""),e=b.match(d);return a?void 0===f[a]?c:f[a]:f},isPartialMode:function(){return WJF.constants.PARTIAL_MODE===!0&&window.top===window.self},redirect:function(a){a=WJF.util.filterUrl(a),window.location.href=a},openUrl:function(a,b){a=WJF.util.filterUrl(a),window.open(a,b)},filterUrl:function(a){if(WJF.constants.DO_NOT_FILTER_URL===!0)return a;if(null==a)return a;var b=new RegExp("^"+window.location.origin);if(a=a.replace(b,""),a.match(/^\/\//))a=window.location.protocol+a;else if(WJF.constants.SERVER_ROOT&&a.match(/^\//)){var c=new RegExp("^"+WJF.constants.SERVER_ROOT+"/");a.match(c)||(a=WJF.constants.SERVER_ROOT+a)}return a},switchToUrl:function(a){a=WJF.util.filterUrl(a),WJF.util.isPartialMode()?(this.TEST_JUMP_LINK=this.TEST_JUMP_LINK||$('<a id="J_test_jump_link" target="main"></a>').appendTo($("body")),this.TEST_JUMP_LINK.attr("href",a),viewLink(this.TEST_JUMP_LINK[0])):this.redirect(a)},createInstance:function(a){var b=new WJF.component.view(a);return WJF.util.isPartialMode()!==!0&&b.init(this.generateId(),WJF.util.getUrlParams()),b},i18n:function(a){a=a||"";var b=arguments[1]||"";arguments[1]instanceof Array||(b=Array.prototype.slice.call(arguments,1));for(var c,d=/%s/,e=a.match(d),f=0;e;)c=b[f++],a=a.replace(e[0],void 0===c?"":c),e=a.match(d);return a},str2json:window.JSON&&window.JSON.parse||function(a){try{return new Function("return "+a).call()}catch(b){return{}}},str2obj:function(a){try{return new Function("return "+a).call()}catch(b){return{}}},json2str:JSON.stringify||function(a){var b=["{"];if(a){for(var c in a){var d;d="object"==typeof a[c]?this.json2str(a[c]):"number"==typeof a[c]?a[c]:'"'+a[c]+'"',b.push('"'+c+'":'+d),b.push(",")}b.pop()}return b.push("}"),b.join("")},html2Txt:function(a){return a=a||"",a.replace(/</g,"&lt;").replace(/>/g,"&gt;")},strToDOMAttr:function(a){return a=a||"",a.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},encodeHtml:function(a){a=(a||"").toString();var b={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#039;"};return function(){return a.replace(/[<>&"']/g,function(a){return b[a]})}()},secHtml:function(a,b,c){var d=this,e=Math.random().toString(36).replace("0.","random"),f=(new DOMParser).parseFromString("<"+e+">"+(a||"")+"</"+e+">","text/html").getElementsByTagName(e)[0],g=[{name:"rull-style",attrs:["style"],reg:/expression\(.*\)/i,replaceValue:""},{name:"rull-href",attrs:["src","href"],reg:/^(javascript|vbscript|jscript|ecmascript):|data:text\/html/i,replaceValue:""},{name:"rule-onevent",attrs:function(){var a=[];for(var b in f)0===b.indexOf("on")&&a.push(b);return a}(),replaceValue:""}];void 0===c&&(c=/\s+/g),b=void 0===b?["A","ADDRESS","B","BIG","BLOCKQUOTE","BR","CAPTION","CENTER","CITE","CODE","DD","DEL","DIV","DL","DT","EM","FONT","H1","H2","H3","H4","H5","H6","HR","I","IMG","KBD","LI","NOBR","OL","P","PRE","S","SECTION","SMALL","SPAN","STRIKE","STRONG","STRONG","SUB","SUP","SVG","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","U","UL","VAR"]:b.split(c).map(function(a){return a.toUpperCase()});var h=function(a){return[].slice.apply(a)};return h(f.querySelectorAll("*")).forEach(function(a,c){b.indexOf(a.tagName)>-1?h(a.attributes).forEach(function(a){g.some(function(b){var c=b.attrs.indexOf(a.nodeName)>-1;return c&&(b.reg&&b.reg.test(a.nodeValue.replace(/\s/g,""))||!b.reg)&&(a.nodeValue=b.replaceValue),c})}):a.outerHTML=d.encodeHtml(a.outerHTML)}),f.innerHTML},html2PureTxt:function(a){return this._body=this._body||document.createElement("body"),this._body.innerHTML=a,this._body.innerText},callBindFn:function(a,b,c){a=$(a),c=$(c);var d,e=a.attr("data-op"),f="1"==a.attr("data-pure"),g=null;if(/&|\|/.test(e)){/&/.test(e)?(e=e.split("&"),g=!1):(e=e.split("|"),g=!0);for(var h=0,i=e.length;h<i;h++){var j=e[h];if(b[j]&&(d=f?b[j]():b[j](a,c)),b.callbackMapping&&b.callbackMapping[j]&&(d=f?b.callbackMapping[j].call(b):b.callbackMapping[j].call(b,a,c)),d===g)return d}return d}return b[e]?f?b[e]():b[e](a,c):!b.callbackMapping||!b.callbackMapping[e]||(f?b.callbackMapping[e].call(b):b.callbackMapping[e].call(b,a,c))},initTabs:function(a,b){b=$.extend({clickSelector:"li",activeCls:"active",tabContentCls:"tab-content",activeTabContentCls:"active"},b);var c=$(a).find("li.active");$(a).on("click",b.clickSelector,function(a){var d=$(this);"LI"!=this.tagName.toUpperCase()&&(d=d.parents("li:first")),c.length&&c[0]!==this&&b.onBeforeTabChange&&b.onBeforeTabChange(c,d)===!1||(c.removeClass("active"),$(c.attr("data-target")).removeClass("active"),d.addClass("active"),$(d.attr("data-target")).addClass("active"),b.onAfterTabChange&&b.onAfterTabChange(d,c),c=d)}),b.triggerEnable&&c.trigger("click")},destroyTabs:function(a){$(a).off()},parseLang:function(a){var a=WJF.constants.LANG_MAPPING[a]?WJF.constants.LANG_MAPPING[a]:"";if(!a)throw"language setting error !";return a},getSystemLang:function(){return WJF.constants.LANG_MAPPING[WJF.constants.LANG]},fileSizeParse:function(a){var b,c,d=1024,e=1024*d,f=1024*e,g=1024*f;return!a||a<d?(b=a||0,c="B"):a<e?(b=a/d,c="KB"):a<f?(b=a/e,c="MB"):a<g?(b=a/f,c="GB"):(b=a/g,c="TB"),b.toFixed(2)+c},timeParse:function(a){function b(a,c){var h,i,j=[];return c===!0&&0==a?j:(!a||a<d?(h=a||0,i="秒",j.push(h+i)):a<e?(h=parseInt(a/d,10),i="秒",j.push(h+i)):a<f?(h=parseInt(a/e),i="分",j.push(h+i),j=j.concat(b(a-h*e,!0))):a<g?(h=parseInt(a/f),i="小时",j.push(h+i),j=j.concat(b(a-h*f,!0))):(h=parseInt(a/g),i="天",j.push(h+i),j=j.concat(b(a-h*g,!0))),j)}for(var c=1,d=1e3*c,e=60*d,f=60*e,g=24*f,h=b(a),i=[],j=0,k=h.length;j<k;j++)h[j]&&i.push(h[j]);return i.join("")},itemToArray:function(a){return a instanceof Array?a:[a]},getBrowserVersion:function(){var a=navigator.appName,b=navigator.appVersion,c=b.split(";");if(!c[1])return{IE6:!1,IE7:!1,IE8:!1,IE9:!1,IE89:!1};var d=c[1].replace(/[ ]/g,""),e={};return"Microsoft Internet Explorer"==a&&"MSIE6.0"==d?e.IE6=!0:"Microsoft Internet Explorer"==a&&"MSIE7.0"==d?e.IE7=!0:"Microsoft Internet Explorer"==a&&"MSIE8.0"==d?e.IE8=!0:"Microsoft Internet Explorer"==a&&"MSIE9.0"==d&&(e.IE9=!0),e.IE8!==!0&&e.IE9!==!0||(e.IE89=!0),e},getBrowserFingerprint:function(a){require(["fingerprint","Encrypter"],function(b,c){var d={excludes:{deviceMemory:!0,language:!1,colorDepth:!1,webdriver:!0,pixelRatio:!1,screenResolution:!0,availableScreenResolution:!0,timezoneOffset:!0,sessionStorage:!0,localStorage:!0,indexedDb:!0,addBehavior:!0,openDatabase:!0,cpuClass:!0,doNotTrack:!0,plugins:!0,canvas:!0,webgl:!0,webglVendorAndRenderer:!0,adBlock:!0,hasLiedLanguages:!0,hasLiedResolution:!0,hasLiedOs:!0,hasLiedBrowser:!0,touchSupport:!0,customEntropyFunction:!0,fonts:!0,fontsFlash:!0,audio:!0,enumerateDevices:!0}};b.get(d,function(d){var e=d.map(function(a){return a.value}),f=b.x64hash128(e.join(""),31);f=c.encrypt(f);var g=(new Date).getTime(),h=["<p>指纹 : "+f+"</p>"];h.push("<p>消耗 : "+((new Date).getTime()-g)+" 毫秒</p>"),h.push("<p>使用的参数 : </p>");for(var i in d){var j=d[i];h.push("<p>"+j.key+" : "+j.value+"</p>")}a&&a(f)})})},log:function(a){window.console.log(a)},error:function(a){window.console.error(a)},warn:function(a){window.console.warn(a)},showNotification:function(a,b,c){function d(a,b){b=b||{};var c=new Notification(a,b);b.icon&&(c.icon=b.icon),c.onclick=function(){b.onClick&&b.onClick.call(null,b),WJF.event.trigger("NOTIFICATION_CLOSE",b)},e.closeNotification(c)}var e=this;if(!("Notification"in window))return!1;if(b=$.extend({renotify:!0,tag:"new_mail"},b),"granted"===Notification.permission)d(a,b);else{if("denied"===Notification.permission)return!1;Notification.requestPermission(function(e){"permission"in Notification||(Notification.permission=e),"granted"===e?(d(a,b),c&&c(!0)):"denied"===e&&c&&c(!1)})}},closeNotification:function(a){"undefined"==typeof a.time||a.time<=0?a.close():(clearTimeout(this.notificationHandle),this.notificationHandle=setTimeout(function(){a.close()},a.time)),a.addEventListener("click",function(){a.close()},!1)},createQuene:function(){return new WJF.queue},debounce:function(a,b,c){function d(b){var c=m,d=n;return m=n=void 0,s=b,p=a.apply(d,c)}function e(a){return s=a,q=setTimeout(h,b),t?d(a):p}function f(a){var c=a-r,d=a-s,e=b-c;return u?Math.min(e,o-d):e}function g(a){var c=a-r,d=a-s;return void 0===r||c>=b||c<0||u&&d>=o}function h(){var a=Date.now();return g(a)?i(a):void(q=setTimeout(h,f(a)))}function i(a){return q=void 0,v&&m?d(a):(m=n=void 0,p)}function j(){void 0!==q&&clearTimeout(q),s=0,m=r=n=q=void 0}function k(){return void 0===q?p:i(Date.now())}function l(){var a=Date.now(),c=g(a);if(m=Array.prototype.slice.call(arguments),n=this,r=a,c){if(void 0===q)return e(r);if(u)return q=setTimeout(h,b),d(r)}return void 0===q&&(q=setTimeout(h,b)),p}var m,n,o,p,q,r,s=0,t=!1,u=!1,v=!0;if("function"!=typeof a)throw new TypeError("Expected a function");return b=+b||0,c&&(t=!!c.leading,u="maxWait"in c,o=u?Math.max(+c.maxWait||0,b):o,v="trailing"in c?!!c.trailing:v),l.cancel=j,l.flush=k,l},throttle:function(a,b){var c=0,d=null;return function(){var e=this,f=Array.prototype.slice.call(arguments),g=+new Date;return g-c<b?(clearTimeout(d),void(d=setTimeout(function(){return c=g,a.apply(e,f)},b))):(c=g,a.apply(e,f))}},loadLess:function(a){"string"==typeof a&&(a=[a]);var b=[];$.each(a||[],function(a,c){c.match(/\.less$/)?b.push('<link rel="stylesheet/less" href="'+c+"?t="+WJF.util.generateId()+'">'):b.push('<link rel="stylesheet" href="'+c+"?t="+WJF.util.generateId()+'">')}),$("head").append(b.join("")),less.registerStylesheets().then(function(){less.refresh()})},adapteUrl:function(a){return a?(a=a.match(/\?/)?a+"&r="+Math.random():a+"?r="+Math.random(),a.match(/\//)&&(a=WJF.constants.SERVER_ROOT+a),a):a}},WJF.queue=function(a){this.init(a)},$.extend(WJF.queue.prototype,{init:function(a){this.opts=$.extend({},a,{bindContext:window}),this.task=[]},add:function(a){this.task&&this.task.push(a)},execute:function(){return this.task&&this.task.length>0?this.task[0].call(this.opts.bindContext):null},remove:function(){return this.task?this.task.shift():null},getTaskCount:function(){return this.task?this.task.length:0},destroy:function(){this.task=null}}),WJF.event={types:{CLICK_BODY:"click_body",WINDOW_RESIZE:"window_resize",RELOAD_PAGE:"reload_page",BEFORE_UNLOAD:"onbeforeunload",URL_SAVE_FILTER:"url_save_filter",MAIL_IMAGES_PREVIEW:"MAIL_IMAGES_PREVIEW",CTRL_S:"CTRL_S",CTRL_ENTER:"CTRL_ENTER"},_callbackMapping:{},on:function(a,b,c){c=c||{},this._callbackMapping[a]?c.first===!0?this._callbackMapping[a].splice(0,0,b):this._callbackMapping[a].push(b):this._callbackMapping[a]=[b]},once:function(a,b){b.__once__=!0,this.on(a,b)},off:function(a,b){b||delete this._callbackMapping[a];var c=this._callbackMapping[a];if(c)for(var d=0,e=c.length;d<e;d++)if(c[d]===b){c.splice(d,1);break}},trigger:function(a){var b=this._callbackMapping[a];if(!b)return!1;var c=Array.prototype.slice.call(arguments,1);if("function"==typeof b)return b.apply(null,c);for(var d=[],e=0;e<b.length;e++){var f=b[e],g=f.apply(null,c);if(f.__once__===!0&&(b.splice(e,1),e--),g===!1||g&&g.result===!1)break;d.push(g)}return d},triggerDocument:function(){$(document).trigger("click")}},WJF.html={getFormData:function(a,b){var c;c="string"==typeof a?$("#"+a):$(a),b=b||{};for(var d=c.serializeArray(),e={},f=0,g=d.length;f<g;f++){var h=d[f],i=h.name,j=b.trim===!1?h.value:$.trim(h.value);void 0!==e[i]?e[i]instanceof Array?e[i].push(j):(e[i]=[e[i]],e[i].push(j)):e[i]=j}return e},getFormData2:function(a,b){function c(a,b){void 0!==e[a]?e[a]instanceof Array?e[a].push(b):(e[a]=[e[a]],e[a].push(b)):e[a]=b}var d;d="string"==typeof a?$("#"+a):$(a),b=$.extend({radioDefaultValue:"",checkboxDefaultValue:[]},b||{});var e={};return d.find("input,textarea,select").each(function(){var a=this.nodeName.toUpperCase(),f=this.name;if(f){var g=null;switch(a){case"INPUT":var h=this.type.toUpperCase();switch(h){case"TEXT":case"PASSWORD":case"HIDDEN":g=this.value;break;case"RADIO":if(this.checked)g=this.value;else if(void 0===e[f]){var i=d.find('input[type="'+h+'"][name="'+f+'"]:checked');0==i.length?e[f]=b.radioDefaultValue:e[f]=i.val()}break;case"CHECKBOX":if(this.checked)g=this.value;else if(void 0===e[f]){var i=d.find('input[type="'+h+'"][name="'+f+'"]:checked');0==i.length?e[f]=b.checkboxDefaultValue:(e[f]=[],$.each(i,function(a,b){e[f].push(this.value)}))}}break;case"TEXTAREA":case"SELECT":g=this.value}null!==g&&c(f,g)}}),e},submitForm:function(a,b,c){function d(a,b){if(null==b||"object"!=typeof b){var c=document.createElement("input");c.type="text",c.name=a,c.value=b,f.appendChild(c)}else for(var e in b)d(a+"["+e+"]",b[e])}c=$.extend({method:"post",target:"_blank"},c),c.adapteUrl!==!1&&(a=WJF.util.adapteUrl(a));var e=$('<form action="'+a+'" method="'+c.method+'" target="'+c.target+'" style="display: none;"></form>').appendTo($("body"));e=e[0];var f=document.createDocumentFragment();for(var g in b){var h=b[g];h instanceof Array?$.each(h,function(a,b){d(g+"["+a+"]",b)}):d(g,h)}e.appendChild(f),e.submit(),"_self"!=c.target&&(e.innerHTML="",e.remove())},clearIframe:function(a,b){if(!a)return!1;a.src="javascript:void(0)";try{a.document?(a.document.write(""),a.document.clear(),a.document.close()):(a.contentDocument.write(""),a.contentDocument.clear(),a.contentDocument.close())}catch(c){}if(b!==!1)try{a.removeNode?a.removeNode():a.remove()}catch(c){WJF.util.error("删除Iframe失败"),WJF.util.error(c)}}},WJF.communication={_showErrLogDetail:function(a,b,c,d){var e='<div class="log-req-response-detail">                <h5 class="req-title">                    请求地址/类型                </h5>                <div class="req-detail">                    {{url}}<br>                    {{config.ajaxOpts.type}} --- {{config.ajaxOpts.dataType}}                </div>                <h5 class="req-title">                    请求参数                </h5>                <div class="req-detail">                    {{data_str}}                </div>                <h5 class="req-title">                    返回数据                </h5>                <div class="req-detail">                    {{response_str}}                </div>            </div>        ',f=template.compile(e);WJF.ui.alert.open(f({url:a,data_str:JSON.stringify(b),response_str:JSON.stringify(c),config:d}),"错误信息[仅内网可见]",{area:["850px","500px"]})},ajax:function(a){var b,c=this;a=$.extend({showMask:null,showLoading:null,type:"post",dataType:"json",data:{},_failure:function(d){var e=d.error||d.errors,g=[];if(e)if("string"==typeof e)g.push(e);else for(var h in e)h in WJF.constants.AJAX_PARAM||("string"==typeof e[h]?g.push(e[h]):e[h]instanceof Array?g.push(e[h].join(",")):g.push(e[h]));else g.push(I18NMessage.common.SYSTEM_ERROR_WAITING_RETRY+" [SYS_ERR_1]");WJF.ui.alert.error(g.join("<br>")||I18NMessage.common.SYSTEM_ERROR_WAITING_RETRY,WJF.constants.ENABLE_RESPONSE_LOG?{btn:[I18NMessage.common.BTN_CONFIRM,I18NMessage.common.BTN_VIEW_DETAIL],btn2:function(){return c._showErrLogDetail(f,b,{data:d,msg:g.join("<br>")},{ajaxOpts:a}),!0}}:null)}},a),"post"==a.type&&$.extend(a.data,WJF.constants.AJAX_PARAM);var d=null;if((WJF.constants.AJAX_LOADING_ENABLE===!0&&a.showMask!==!1&&a.showLoading!==!1||a.showMask||a.showLoading)&&(d=this.showLoading(a.maskMsg||a.loadingMsg)),b=a.data,b&&"string"!=typeof b){b=$.extend({},b);for(var e in b)b[e]instanceof Array&&0==b[e].length&&(b[e]=null)}var f=a.url;f=f.match(/\?/)?f+"&rd="+Math.random():f+"?rd="+Math.random(),f=WJF.util.filterUrl(f);(new Date).getTime();return $.ajax({url:f,type:a.type,data:b,async:a.async!==!1,dataType:a.dataType,timeout:a.timeout||6e4,success:function(b){if("401"==b.code)return void WJF.ui.alert.warn(I18NMessage.common.CURRENT_LOGOUT_AGAIN_LOGIN,function(){window.location.href="/"});var c=!0;if("200"==b.code&&(c=a.success&&a.success.call(a.context||null,b)),"200"!=b.code||c===!1)if(a.failure){var d=!!a.failure&&a.failure.call(a.context||null,b);d===!1&&a._failure(b)}else a._failure(b)},error:function(d,e,g){var h=null;a.error&&(h=a.error.apply(a.context||null,Array.prototype.slice.call(arguments))),null!==h&&h!==!1||"abort"==e||("timeout"==e?WJF.ui.alert.error(I18NMessage.common.NET_TIME_PUT_WARN):"parsererror"==e?WJF.ui.alert.error(I18NMessage.common.SYSTEM_RETURN_DATA_ERROR,WJF.constants.ENABLE_RESPONSE_LOG?{btn:[I18NMessage.common.BTN_CONFIRM,I18NMessage.common.BTN_VIEW_DETAIL],btn2:function(){return c._showErrLogDetail(f,b,e,{ajaxOpts:a}),!0}}:null):"error"==e?WJF.ui.alert.error(WJF.constants.AJAX_ERROR_MSG,WJF.constants.ENABLE_RESPONSE_LOG?{btn:[I18NMessage.common.BTN_CONFIRM,I18NMessage.common.BTN_VIEW_DETAIL],btn2:function(){return c._showErrLogDetail(f,b,e,{ajaxOpts:a}),!0}}:null):WJF.ui.alert.error(e||I18NMessage.common.SYSTEM_ERROR_WAITING_RETRY+" [SYS_ERR_2]",WJF.constants.ENABLE_RESPONSE_LOG?{btn:[I18NMessage.common.BTN_CONFIRM,I18NMessage.common.BTN_VIEW_DETAIL],btn2:function(){return c._showErrLogDetail(f,b,e,{ajaxOpts:a}),!0}}:null))},complete:function(){d&&c.hideLoading(d),a.complete&&a.complete.apply(a.context||null)}})},post:function(a,b,c,d,e){WJF.communication.ajax($.extend({url:a,data:b,type:"post",success:c,error:d},e))},get:function(a,b,c,d,e){WJF.communication.ajax($.extend({url:a,data:b,type:"get",success:c,error:d},e))},showLoading:function(a,b){return WJF.ui.alert.loadingSTip(a||I18NMessage.common.COMMON_LOADING)},hideLoading:function(a){return WJF.ui.alert.close(a)}},WJF.serviceManager={prepareParams:function(a,b,c,d,e){return d&&"function"!=typeof d?e=$.extend({},e,d):"function"==typeof e&&(e={failure:e}),$.extend({url:a,data:b,success:c,error:"function"==typeof d?d:null},e)},service:function(a,b,c,d,e){var f=this.prepareParams(a,b,c,d,e);return WJF.communication.ajax(f)},get:function(a,b,c,d,e){e=e||{};var f=this.prepareParams(a,b,c,d,e);return f.type="get",WJF.communication.ajax(f)},post:function(a,b,c,d,e){e=e||{};var f=this.prepareParams(a,b,c,d,e);return f.type="post",WJF.communication.ajax(f)},addServices:function(a,b){return this.serviceName?(alert(I18NMessage.common.ADD_SERVICE_REPEAT),!1):void(this[a]=b)}},layer.__prepareParams__=function(a,b){return a[1]=a[1]||{},"function"==typeof a[1]&&a.splice(1,0,{}),$.extend(a[1],{title:I18NMessage.common.WARM_PROMPT},b),a},layer.error=function(a,b){var c=Array.prototype.slice.call(arguments);return c=layer.__prepareParams__(c,{icon:2}),layer.alert.apply(layer,c)},layer.warn=function(a,b){var c=Array.prototype.slice.call(arguments);return c=layer.__prepareParams__(c,{icon:0}),layer.alert.apply(layer,c)},layer.success=function(a,b){var c=Array.prototype.slice.call(arguments);return c=layer.__prepareParams__(c,{icon:1}),layer.alert.apply(layer,c)},WJF.ui={};var LAYER_CONTENT_TPL='<div class="dialog-wrap-container">        <div class="dialog-wrap-title">            <i class="{{iconType}}"></i>            <div>                {{#content}}            </div>        </div>        {{ if subContent}}        <div class="dialog-wrap-line"></div>        <div class="dialog-wrap-txt">            <div class="blue-link dialog-detail-switcher" onclick="WJF.event.trigger("TOGGLE_COMMON_CLS",this)">'+I18NMessage.common.DETAIL_INFO+'<i></i></div>            <div class="dialog-detail-text">                {{#subContent}}            </div>        </div>        {{/if}}    </div>';WJF.ui.alert={},$.extend(WJF.ui.alert,{_layerContentTplFn:template.compile(LAYER_CONTENT_TPL),_parseParams:function(a,b,c){var d;if(b)if("string"==typeof b)c=c||{},c.title=b!==!1&&(b||I18NMessage.common.WARM_PROMPT),d={msg:a,config:c};else if("function"==typeof b)if("function"==typeof c){var e={yes:b,cancel:c};d={msg:a,config:e}}else d=$.extend(!0,{msg:a,config:{yes:b}},c);else b=b||{},b.title=b.title!==!1&&(b.title||I18NMessage.common.WARM_PROMPT),d={msg:a,config:b};else"string"==typeof a?d={msg:a,config:{}}:(d=a,d.config=d.config||{});return d.config.__cancel__=d.config.cancel,d.config.__destroy__=function(a,b){b.destroyShortcut(),d.config.onBeforeDestroy&&d.config.onBeforeDestroy.call(d.config.bindContext);var c=$("#layui-layer"+a+" .layui-layer-content");if(c.off(),d.config.bindContext&&d.config.bindContext.popEvents){var e=d.config.bindContext.popEvents;for(var f in e)c.off(f)}d.config.bindContext=null,delete d.config.bindContext},d.config.cancel=function(a,b){return d.config.__cancel__?d.config.__cancel__(a,b)===!1?(WJF.ui.alert.hide(a),!1):(d.config.__destroy__(a,d.config.proxyLayerObj),!0):d.config.cache===!0?(d.config.onBeforeHide&&d.config.onBeforeHide(a,b)!==!1&&WJF.ui.alert.hide(a),!1):(d.config.__destroy__(a,d.config.proxyLayerObj),!0)},d.content&&(d.msg=d.content),d},_pareseLayerObj:function(a,b,c){var d={_layerId:a,getId:function(){return this._layerId},hide:function(){WJF.ui.alert.hide(this._layerId)},show:function(){WJF.ui.alert.show(this._layerId)},close:function(){b.__destroy__&&b.__destroy__(this._layerId,this),WJF.ui.alert.close(this._layerId)},setContent:function(a){this.getContent().html(a)},getContent:function(){return $("#layui-layer"+this._layerId+" .layui-layer-content")},getWrapper:function(){return this.getContent()},destroy:function(){this.close()},handleKeyDown:function(c){if(b.shortcut===!0){var d=c.event;if(!(d.shiftKey||d.ctrlKey||d.altKey)){var e=c.keyCode;switch(e){case 13:case 89:throw b.yes&&b.yes(),layer.close(a),"SKIP TRIGGER";case 27:throw b.cancel?b.cancel()!==!1&&layer.close(a):layer.close(a),"SKIP TRIGGER"}}}},proxyShortcut:function(){WJF.event.on("KEYDOWN",this.handleKeyDown,{first:!0})},destroyShortcut:function(){WJF.event.off("KEYDOWN",this.handleKeyDown)}};b.noPadding&&(b.appendCls=(b.appendCls||"")+" no-padding"),b.appendCls=b.appendCls||"",b.appendCls+=" "+WJF.util.getSystemLang(),b&&b.appendCls&&$("#layui-layer"+a).addClass(b.appendCls);var e=d.getWrapper();return b.bindContext&&(WJF.util.isPartialMode()!==!0&&b.proxyCommonClick!==!0||e.on("click",".J-op",function(a){var c=$(this).attr("data-op");if(!c)return!1;var d=WJF.util.callBindFn(this,b.bindContext,a.target);return void 0!==d&&d}),b.proxyBindDomEvent===!0?WJF.component.view.prototype._bindDomEvent.call(b.bindContext,e,b.bindContext.popEvents||null):b.bindContext._bindDomEvent(e,b.bindContext.popEvents||null)),b.proxyLayerObj=d,b.focus!==!1&&e.find("input,textarea")[0]&&e.find("input,textarea")[0].focus(),d},open:function(a,b,c,d){var e=this._parseParams(a,b,c,d),f=$.extend({resize:!1,type:1,title:e.config&&e.config.title||I18NMessage.common.WARM_PROMPT,content:e.msg,iconType:d},e.config);f.btn===!1||f.btn&&0!=f.btn.length||(f.btn=[],f.yes&&f.btn.push(I18NMessage.common.BTN_CONFIRM),0==f.btn.length?f.__cancel__!==!1&&f.btn.push(I18NMessage.common.BTN_CONFIRM):f.__cancel__!==!1&&f.btn.push(I18NMessage.common.BTN_CANCEL),0==f.btn.length&&f.btn.push(I18NMessage.common.BTN_CONFIRM)),d&&(f.content=this._layerContentTplFn(f));var g=layer.open(f),h=this._pareseLayerObj(g,e.config,f);return setTimeout(function(){c&&c.shortcut===!0&&h.proxyShortcut()},0),h},success:function(a,b,c){return this.open(a,b,c,"success")},error:function(a,b,c){return this.open(a,b,c,"error")},warn:function(a,b,c){return this.open(a,b,c,"warn")},alert:function(a,b,c){return this.open(a,b,c,"alert")},confirm:function(a,b,c){return this.open(a,b,c,"confirm")},prompt:function(a,b){return layer.prompt(a,b)},msg:function(a,b,c,d){if("function"==typeof b){b={yes:b,no:c};var e=this._parseParams(a,b),f=layer.msg(e.msg,e.config);return this._pareseLayerObj(f,e.config)}b=$.extend({title:!1},b);var e=this._parseParams(a,b),f=layer.msg(e.msg,e.config,c,d);return this._pareseLayerObj(f,e.config)},_prepareTipMsg:function(a,b){return a='<div class="tip-container"><div class="tip-msg '+b+'"><i></i>'+a+"</div></div>"},_prepareTipConfig:function(a){return a=$.extend({time:4e3,appendCls:"layui-layer-custom-tip",offset:["170px","576px"],showFocusAssistant:!1},a)},warnTip:function(a,b){return this.msg(this._prepareTipMsg(a,"warn"),this._prepareTipConfig(b))},loadingTip:function(a,b){return b=b||{time:2e7},this.msg(this._prepareTipMsg(a,"loading"),this._prepareTipConfig(b))},loadingSTip:function(a,b){return b=b||{time:2e7},this.msg(this._prepareTipMsg(a,"small-loading"),this._prepareTipConfig(b))},successTip:function(a,b){return this.msg(this._prepareTipMsg(a,"success"),this._prepareTipConfig(b))},close:function(a){return a._layerId?void a.close():(a=a._layerId||a,void layer.close(a))},hide:function(a){a=a._layerId||a,$("#layui-layer"+a).hide(),$("#layui-layer-shade"+a).hide()},show:function(a){a=a._layerId||a,$("#layui-layer-shade"+a).show(),$("#layui-layer"+a).show()}}),WJF.ui.grid=function(a){this.validateParam(a)&&this.init(a)},WJF.ui.grid.prototype={constructor:WJF.ui.grid,paginationBarTplFn:template.compile('<div class="pagination-bar">        <span class="summary">共有{{totalCount}}个联系人</span>        {{if totalPage>0}}        <div class="pagination-btns">            <span class="icon-prev prev-page"></span>            <div class="dropdown up">                <div class="dropdown-bar">{{currentPage}}/{{totalPage}}页<i></i></div>                {{if arr.length>0}}                <ul class="dropdown-list">                    {{each arr as item index}}                    <li data-value="{{index+1}}">{{index+1}}/{{totalPage}}页 <i></i></li>                    {{/each}}                </ul>                {{/if}}            </div>            <span class="icon-next next-page"></span>        </div>        {{/if}}    </div>'),init:function(a){a=this.options=$.extend({url:null,defaultSuccessCode:"200",reqParams:{},dataArray:null,pageSize:20,pageSizeName:"pageSize",pagerId:null,pagerTpl:null,pageNum:1,pageNumName:"page",rowsPath:"rows",totalPagePath:"pageCount",totalPage:1,totalCountPath:"totalCount",totalCount:0,noDataMsg:I18NMessage.common.NOT_FOUND_DATA_TRY_AGAIN,initMsg:I18NMessage.common.INITIALIZE_INFO},a),"string"==typeof a.tbodyDomId?a.$tbody=$("#"+a.tbodyDomId):a.$tbody=$(a.tbodyDomId),this.$pagerDom=$("#"+this.options.pagerId),a.columnCount||(a.columnCount=a.$tbody.prev().find("tr th").length),this.updatePager(),a.url?this.fetchData(!1):this.loadData([],!1),this.regEvent()},regEvent:function(){var a=this.options,b=this;a.$tbody.on("click",".load-more",function(){$(this).parent().text(WJF.util.i18n(I18NMessage.common.PAGE_WHICH_PAGE,a.pageNum+1)),b.updatePaginationParams(a.pageNum+1),b.fetchData(!0)}),a.$tbody.prev().on("click",".sort",function(){var a=$(this).attr("class"),c=a.match(/sort-by-(\S+)/);c&&(c=c[1]),b.options.sortCallBack&&b.options.sortCallBack.call(b,c,this)}),this.$pagerDom.on("click",".prev-page",function(){b.prevPage()}),this.$pagerDom.on("click",".next-page",function(){b.nextPage()}),this.$pagerDom.on("click",".dropdown-bar",function(){return $(this).parent().toggleClass("active"),!1}),this.$pagerDom.on("click",".dropdown-list li",function(){var a=$(this).attr("data-value");return $(this).parents(".dropdown").removeClass("active"),b.jumpTo(a),!1})},loadData:function(a,b){var c=this.options;a||(a=[]);var d="";c.tbodyRender?d=c.tbodyRender.call(this,a):c.tbodyRenderTpl&&(d=template(c.tbodyRenderTpl,{list:a,columnCount:this.options.columnCount,renderConf:this.options.renderConf||{}})),d||(d='<tr><td colspan="'+c.columnCount+'"><div style="text-align:center;padding:30px;font-size:14px;">'+c.noDataMsg+"</div></td></tr>"),b?c.$tbody.append(d):c.$tbody.html(d),this.updatePager(),c.afterRender&&c.afterRender.call(this,c)},sortBy:function(a){},updatePager:function(){var a=[],b=this.options;a.length=b.totalPage||1;var c={currentPage:b.pageNum||1,totalPage:b.totalPage||1,totalCount:b.totalCount||0,arr:a};b.pagerTpl?"function"==typeof b.pagerTpl?this.$pagerDom.html(b.pagerTpl(c)):this.$pagerDom.html(template(b.pagerTpl,c)):this.$pagerDom.html(this.paginationBarTplFn(c))},refresh:function(){this.fetchData(!1)},reload:function(){var a={};a[this.options.pageNumName]=1,this.setRequestParams(a),this.fetchData(!1)},jumpTo:function(a){var b={};b[this.options.pageNumName]=a,this.setRequestParams(b),this.fetchData(!1)},showLoading:function(){},hideLoading:function(){},fetchData:function(a){var b=this,c=this.options;b._loading=!0;var d=$.extend(!0,{},c.reqParams);d[c.pageNumName]=c.pageNum,d[c.pageSizeName]=c.pageSize,"get"!=c.type&&$.extend(d,WJF.constants.AJAX_PARAM),this.showLoading(!0);
var e=WJF.util.filterUrl(c.url);$.ajax({type:c.type||"post",data:d,url:e,dataType:c.dataType||"json",success:function(d){var e=d;if("string"==typeof d)try{e=new Function("return"+d)()}catch(f){return void(c.onloadFailure?c.onloadFailure.call(this,d,I18NMessage.common.RESOLVE_DATA_FAIL):alert(I18NMessage.common.JSON_DATA_TRANSITION_FAIL_ERROR_INFO+f.message))}b.handleResponseData(e,a)},error:function(a,d,e){c.onLoadError?c.onLoadError.call(b,a,d,e):WJF.ui.alert.error(I18NMessage.common.NETWORK_BUSY_WAITING_RETRY),b.loadData([])},complete:function(a,c){b._loading=!1,b.hideLoading()}})},handleResponseData:function(resp,isAppend){var options=this.options;if(options.dataFilter&&options.dataFilter.call(this,resp,isAppend),resp.code==options.defaultSuccessCode)try{this.__resp__=resp;var rowsStr="this.__resp__."+options.rowsPath,totalPageStr="this.__resp__."+options.totalPagePath,totalCountStr="this.__resp__."+options.totalCountPath,rows=eval(rowsStr),totalPage=eval(totalPageStr),totalCount=eval(totalCountStr);this.options.totalPage=totalPage,this.options.totalCount=totalCount,this.options.lastLoadedRows=rows,this.loadData(rows,isAppend),this.__resp__=void 0,options.onloadSuccess&&options.onloadSuccess.call(this,resp)}catch(e){this.options.lastLoadedRows=[],this.loadData([],isAppend),options.onloadFailure?options.onloadFailure.call(this,resp,I18NMessage.common.RESOLVE_DATA_FAIL):alert(I18NMessage.common.RESOLVE_DATA_FAIL)}else this.options.lastLoadedRows=[],this.loadData([],isAppend),options.onloadFailure&&options.onloadFailure.call(this,resp),"401"==resp.code&&(window.location.href="/")},setRequestParams:function(a,b){"string"==typeof a?this.options.reqParams=a:b===!0?this.options.reqParams=$.extend(!0,{},a):this.options.reqParams=$.extend(!0,this.options.reqParams,a)},updatePaginationParams:function(a,b){/^[0-9]+/.test(a)&&(this.options.pageNum=parseInt(a,10)),/^[0-9]+/.test(b)&&(this.options.pageSize=parseInt(b,10))},prevPage:function(){var a=this.options.pageNum;a<2||(this.updatePaginationParams(a-1),this.fetchData(!1))},nextPage:function(){var a=this.options.pageNum;a<this.options.totalPage&&(this.updatePaginationParams(a+1),this.fetchData(!1))},selectAll:function(){},unSelectAll:function(){},setOptions:function(a){$.extend(this.options,a)},getLoadedRows:function(){return this.options.lastLoadedRows||[]},validateParam:function(a){return a.tbodyDomId?!("function"!=typeof a.tbodyRender&&!a.tbodyRenderTpl)||(alert("必须传递tbodyRender函数 或 tbodyRenderTpl"),!1):(alert("Error:必须制定tbodyDom id"),!1)}},WJF.ui.grid.constructor=WJF.ui.grid,WJF.plugins={},WJF.plugins.uploader=function(a){this.validateParam(a)&&this.init(a)},WJF.plugins.uploader.prototype={constructor:WJF.plugins.uploader,init:function(a){a=this.options=$.extend(!0,{swf:WJF.constants.SCRIPT_BASE+"lib/webuploader/Uploader.swf",server:null,method:"POST",formData:{},fileVal:"file",singleFileUpload:!0,pick:null,compress:!1,chunked:!1,chunkSize:2097152,threads:15,accept:{title:"Images",extensions:"gif,jpg,jpeg,bmp,png",mimeTypes:"image/jpg,image/jpeg,image/png,image/gif,image/bmp"},events:{}},a),a.server=WJF.util.filterUrl(a.server),this.uploader=WebUploader.create(a),this.regEvent()},regEvent:function(){var a=this.options,b=this,c=a.events;c.uploadError=c.uploadError||function(a){WJF.ui.alert.error(I18NMessage.common.UPDATE_FAIL_WAITING_RETRY)};var d=c.fileQueued;c.fileQueued=function(c){if(a.singleFileUpload)for(var e=b.uploader.getFiles().slice(0),f=0,g=e.length-1;f<g;f++)b.uploader.removeFile(e[f]);var h=Array.prototype.slice.call(arguments);d&&d.apply(b,h)};var e=c.error;c.error=function(c){var d=Array.prototype.slice.call(arguments),f=e&&e.apply(b,d);if(void 0===f||f===!1)switch(c){case"Q_EXCEED_NUM_LIMIT":WJF.ui.alert.error(I18NMessage.common.MORE_THAN_BIGGER_SUPPORT_FILE_NUMBER);break;case"Q_EXCEED_SIZE_LIMIT":WJF.ui.alert.error(I18NMessage.common.ALL_FILE_SIZE_TOO_BIG);break;case"Q_TYPE_DENIED":WJF.ui.alert.error(WJF.util.i18n(I18NMessage.common.CONFIRM_CHECK_FILE_FORMAT,a.accept.extensions));break;case"Q_TYPE_FILE_EMPTY":WJF.ui.alert.error(d[1].name+" "+I18NMessage.common.FILE_SIZE_EMPTY);break;case"F_EXCEED_SIZE":WJF.ui.alert.error(WJF.util.i18n(I18NMessage.common.FILE_SIZE_TOO_BIG_WARN,d[2].name,WJF.util.fileSizeParse(b.options.fileSingleSizeLimit)))}};for(var f in c)!function(a){b.uploader.on(a,function(){var d=Array.prototype.slice.call(arguments);if("function"==typeof c[a])return c[a].apply(b,d)})}(f)},validateParam:function(a){return!0},removeFileFromQueue:function(a){var b=a;"string"==typeof a&&(b=this.uploader.getFile(a)),this.uploader.removeFile(b,!0)},removeAllFileFromQueue:function(){var a=this.uploader.getFiles(),b=this;$.each(a||[],function(a,c){b.uploader.removeFile(c,!0)})},isProgressing:function(){var a=this.uploader.getStats(),b=a.progressNum>0||this.uploader.isInProgress();if(b)return b;if(this.options.chunked===!1)return!1;var c=this.uploader.getFiles("complete");return $.each(c,function(a,c){if(!c.upload_status.merge_status||c.upload_status.merge_status==-1)return b=!0,!1}),b},getUploadStatus:function(){if(this.options.chunked===!1)return this.writeMailSmallUploader.uploader.getStats();var a=this.uploader.getFiles(),b={total:a.length,success:0,progress:0,error:this.uploader.getFiles("error").length,interrupt:this.uploader.getFiles("interrupt").length},c=this.uploader.getFiles("complete");$.each(c,function(a,c){c.upload_status.merge_status&&c.upload_status.merge_status!=-1?b.success++:c.progress++});var d=this.uploader.getFiles("progress");return b.progress+=d.length,b},destroy:function(){this.uploader.destroy()}},WJF.plugins.uploader.constructor=WJF.plugins.uploader,WJF.ui.autoComplete=function(a){this.validateParam(a)&&this.init(a)},WJF.ui.autoComplete.prototype={constructor:WJF.ui.autoComplete,autoCompleteListTplFn:template.compile('            {{if list&&list.length}}                {{each list as item }}                    <li data-value="{{item.value}}" data-desc="{{item.desc}}"><div class="title">{{item.desc}}</div></li>                {{/each}}            {{else}}            {{/if}}    '),init:function(a){a=this.options=$.extend({url:null,dataList:null,defaultSuccessCode:"200",reqParams:{},desckeyName:"search",valueKeyName:"value",spaceTime:100,reqType:"get",multi:!1,autoCompleteListTpl:null,onChanged:null,keepOrignInputName:!1},a),this.data={},this.dom=$(a.dom),this.hiddenDom=$('<input type="hidden" name="'+a.valueKeyName+'">').insertAfter(this.dom),a.keepOrignInputName!==!0&&this.dom.removeAttr("name"),a.multi?(this.dom.wrapAll($('<div class="autocomplete-items-wrapper multi"></div>')),this.fakeDom=this.dom.parent(),this.listWrapper=$('<div class="autocomplete-wrapper"><ul class="autocomplete-list"></ul></div>').appendTo(this.fakeDom),this.autoCompleteList=this.listWrapper.find("ul.autocomplete-list")):(this.listWrapper=$('<div class="autocomplete-wrapper"><ul class="autocomplete-list"></ul></div>').insertAfter(this.dom),this.autoCompleteList=this.listWrapper.find("ul.autocomplete-list")),this.regEvent(),this.getMatchedList()},regEvent:function(){var a=this.options,b=this;this.dom.on("keyup",function(){b.getMatchedList({showMatched:!0})}),this.dom.on("click",function(){return b.autoCompleteList.find("li").length&&b.listWrapper.toggleClass("active"),!1}),this.listWrapper.on("click","li",function(){if(a.multi)$(this).toggleClass("active");else{b.listWrapper.removeClass("active"),$(this).siblings("li").removeClass("active");var c=$(this).attr("data-value"),d=$(this).attr("data-desc");b.hiddenDom.val(c),b.dom.val(d),a.onChanged&&a.onChanged.call(b,c,d)}}),WJF.event.on(WJF.event.types.CLICK_BODY,this.globalClick=function(){b.listWrapper.removeClass("active")})},addSelectedItem:function(a){this.listWrapper},getMatchedList:function(a){var b=this,c=this.options,d=$.extend({},c.reqParams);return d[c.desckeyName]=$.trim(this.dom.val()),c.dataList?void b.renderMatchedList(c.dataList,d,a):(this.fetchAjaxXHR&&this.fetchAjaxXHR.abort(),clearTimeout(this.fetchTimeHandler),void(this.fetchTimeHandler=setTimeout(function(){b.fetchAjaxXHR=WJF.serviceManager[c.reqType](c.url,d,function(c){b.renderMatchedList(c,d,a)})},this.options.spaceTime)))},renderMatchedList:function(a,b,c){var d=this.options;if("function"==typeof d.dataFilter){var e=d.dataFilter.call(this,a);void 0!==e&&(a=e)}d.autoCompleteListTpl?"function"==typeof d.autoCompleteListTpl?this.autoCompleteList.html(d.autoCompleteListTpl(a)):this.autoCompleteList.html(template(d.autoCompleteListTpl,a)):this.autoCompleteList.html(this.autoCompleteListTplFn(a)),0==a.list.length&&(this.listWrapper.removeClass("active"),this.hiddenDom.val("")),c&&c.showMatched===!0&&a.list.length>0&&this.listWrapper.addClass("active")},getSelected:function(){var a=this.options;if(!a.multi)return{value:this.hiddenDom.val(),desc:this.dom.val()}},setOptions:function(a){$.extend(this.options,a)},destroy:function(){this.options.multi||(this.dom.val(""),this.hiddenDom.val("")),this.dom.off(),this.listWrapper.off(),WJF.event.off(WJF.event.types.CLICK_BODY,this.globalClick)},validateParam:function(a){return!0}},WJF.ui.autoComplete.constructor=WJF.ui.autoComplete,WJF.component={},WJF.component.view=function(a){$.extend(this,a),this.componentId=WJF.util.generateId(),this._init=this.init,this.viewData={sceneHistory:[]},this.init=function(a,b){this.beforeCreate(a,b),this._init(a,b),this.pageViewInstance&&this.pageViewInstance.setOptions&&(this.pageViewInstance.setOptions({pageContext:this}),this.pageViewInstance.setOptions(this.pageViewConfig))}},$.extend(WJF.component.view.prototype,{switchScene:function(a,b,c){if(!this.onBeforeSwitchScene||this.onBeforeSwitchScene(a,b,c)!==!1){if(!a||a.attr&&"switchScene"==a.attr("data-op"))return void(this.viewData.sceneHistory.length&&(this.viewData.sceneHistory.pop(),this.switchScene(this.viewData.sceneHistory.pop())));var d=!1,c=c||{},e=null;if("string"!=typeof a?(e=$(a),a=e.attr("id")):e=this.pageWrapper.find("#"+a),a==this.viewData.sceneHistory[this.viewData.sceneHistory.length-1]){if(c.reload!==!0)return;d=!0}if(!e.hasClass("active")||d){e.addClass("active").siblings(".scene-content").removeClass("active"),"0"===e.attr("backable")||d||this.viewData.sceneHistory.push(a);var f=e.attr("data-init");"function"==typeof this[f]&&this[f](e,b)}}},destroyScene:function(a){function b(a){var b=c.pageWrapper.find("#"+a);b.off(),b.remove()}var c=this;return a?void b(a):($.each(this.viewData.sceneHistory,function(c,d){b(a)}),void(this.viewData.sceneHistory=[]))},beforeCreate:function(a,b){b&&$.isEmptyObject(b)&&(b={getPageId:function(){return 1}}),b&&(b.getPageId=b.getPageId||function(){return 1}),this.pageViewInstance=b,this.pageView=b,this.pageId=a,WJF.util.isPartialMode()?(this.pageWrapper=$("#J_mtc_"+a),this.pageViewParams=b.opts.queryParams):(this.pageWrapper=$("body"),this.pageViewParams=WJF.util.getUrlParams()),this.pageViewParams=this.pageViewParams||{},this.pageViewParams._cacheKey_&&"undefined"!=typeof CommonTool&&(this.pageViewParams._cacheData_=CommonTool.getCacheData(this.pageViewParams._cacheKey_,!1))},init:function(){this._error("function init must be implemented ....")},bindEvent:function(){var a=this;if(this.customEvents)for(var b in this.customEvents)WJF.event.on(b,function(b){return function(){var c=Array.prototype.slice.call(arguments);c.splice(1,0,this);var d=a.customEvents[b];return"string"==typeof d?a[d].apply(a,c):d.apply(a,c)}}(b));!this.events||this.pageViewInstance&&this.pageViewInstance.opts&&this.pageViewInstance.opts.isIframe||this._bindDomEvent()},_bindDomEvent:function(a,b){if(null!==b){b=b||this.events;var c=this;a=a||c.pageWrapper;for(var d in b){var e=b[d],f=$.trim(d).split(" "),g=f[0];d=$.trim(f.splice(1).join(" ")),a.on(g,d,function(a){return function(){var b=Array.prototype.slice.call(arguments);return b.splice(1,0,this),"string"==typeof a?c[a].apply(c,b):a.apply(c,b)}}(e))}}},unBindEvent:function(){if(this.pageWrapper.off(),this.customEvents)for(var a in this.customEvents)WJF.event.off(a);this._unbindEvent=!0},onBeforeDestroy:function(){this._error("must implement function onBeforeDestroy....")},_error:function(a){var b=$("#tab_"+this.pageId).text()||"";throw alert("[ Error: "+b+" ]\n"+a),a},post:function(){this.data.AJAX_LOADING_ENABLE===!0&&(WJF.constants.AJAX_LOADING_ENABLE=!0);var a=WJF.serviceManager.post.apply(WJF.serviceManager,Array.prototype.slice.call(arguments));return WJF.constants.AJAX_LOADING_ENABLE=!1,CommonTool.xhrMapping[this.pageId]=CommonTool.xhrMapping[this.pageId]||[],a.always=function(){},CommonTool.xhrMapping[this.pageId].push(a),a},get:function(){this.data.AJAX_LOADING_ENABLE===!0&&(WJF.constants.AJAX_LOADING_ENABLE=!0);var a=WJF.serviceManager.get.apply(WJF.serviceManager,Array.prototype.slice.call(arguments));return WJF.constants.AJAX_LOADING_ENABLE=!1,CommonTool.xhrMapping[this.pageId]=CommonTool.xhrMapping[this.pageId]||[],a.always=function(){},CommonTool.xhrMapping[this.pageId].push(a),a},log:function(a){$("#tab_"+this.pageId).text()||""},time:function(a,b){},closeSelfTab:function(){if(WJF.util.isPartialMode()!==!0)return!1;var a=pageViewController.closeTab(this.pageViewInstance.getPageId());return a},refreshSelfTab:function(){if(WJF.util.isPartialMode()!==!0)return!1;var a=this.pageViewInstance.reloadView();return a},destroy:function(){this._unbindEvent||this.unBindEvent(),$.each(CommonTool.xhrMapping[this.pageId]||[],function(a,b){b.abort()}),delete CommonTool.xhrMapping[this.pageId],this.pageWrapper.find("iframe").each(function(a,b){b.src=""}),this.pageWrapper.find(".J_Common_Validator").each(function(){var a=$(this).data("Common_validator");a&&a.destory()}),this.destroyScene();var a=this.data;for(var b in a)a[b]=null;for(var b in this)delete this[b];this.destroyed=!0}});